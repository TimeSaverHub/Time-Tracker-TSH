(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{6988:function(e,r,t){Promise.resolve().then(t.bind(t,5107))},5107:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return l}});var n=t(7437),a=t(2265),i=t(9376),s=t(9666),u=t(2476);function o(e){let{children:r}=e,t=(0,i.useRouter)(),{currentUser:o,loading:l}=(0,s.a)();return((0,a.useEffect)(()=>{l||o||t.push("/login")},[o,l,t]),l)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)(u.T,{})}):o?(0,n.jsx)(n.Fragment,{children:r}):null}function l(e){let{children:r}=e;return(0,n.jsx)(o,{children:r})}},2476:function(e,r,t){"use strict";t.d(r,{T:function(){return a}});var n=t(7437);function a(){return(0,n.jsx)("div",{className:"flex justify-center items-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}},9666:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return w},a:function(){return m}});var n=t(7437),a=t(2265),i=t(9376),s=t(3301),u=t(5978),o=t(738);let l=(0,o.C6)().length>0?(0,o.Mq)():(0,o.ZF)({apiKey:"AIzaSyBaDHrLtTLBb7QViuG2800nLTTaCyY2uy4",authDomain:"timetracker-tsh.firebaseapp.com",projectId:"timetracker-tsh",storageBucket:"timetracker-tsh.firebasestorage.app",messagingSenderId:"515583830047",appId:"1:515583830047:web:2d93143879a9cd015c0d2a"}),c=(0,s.v0)(l),d=(0,u.ad)(l);new s.hJ;let h=(0,a.createContext)(null);async function f(e,r){if(!e)return;let t=(0,u.JU)(d,"users",e.uid);if(!(await (0,u.QT)(t)).exists()){let{email:n,photoURL:a,displayName:i}=e,s=new Date;try{await (0,u.pl)(t,{email:n,photoURL:a,name:(null==r?void 0:r.name)||i||(null==n?void 0:n.split("@")[0]),createdAt:s,updatedAt:s})}catch(e){throw console.error("Error creating user document:",e),Error("Failed to create user profile")}}return t}function p(e){switch(e.code){case"auth/wrong-password":return"Invalid email or password";case"auth/user-not-found":return"No user found with this email";case"auth/email-already-in-use":return"Email already in use";case"auth/weak-password":return"Password should be at least 6 characters";default:return"An error occurred. Please try again"}}function w(e){let{children:r}=e,t=(0,i.useRouter)(),[o,l]=(0,a.useState)(null),[w,m]=(0,a.useState)(!0),[y,g]=(0,a.useState)(null),[b,v]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0,r=(0,s.Aj)(c,async r=>{if(e)try{if(r){let e=await (0,u.QT)((0,u.JU)(d,"users",r.uid)),t={id:r.uid,email:r.email,name:e.exists()?e.data().name:r.displayName,photoURL:r.photoURL};l(t)}else l(null)}catch(e){console.error("Error in auth state change:",e),g(e instanceof Error?e.message:"Authentication error")}finally{e&&m(!1)}});return()=>{e=!1,r()}},[]),(0,a.useEffect)(()=>{if(w||b)return;let e=window.location.pathname;o?("/login"===e||"/signup"===e||"/"===e)&&t.push("/dashboard"):"/login"!==e&&"/signup"!==e&&t.push("/login")},[o,w,b,t]);let x=async(e,r)=>{try{g(null),v(!0),await (0,s.e5)(c,e,r),t.push("/dashboard")}catch(e){throw console.error("Sign in error:",e),g(p(e)),e}finally{v(!1)}},E=async()=>{try{g(null),v(!0);let e=new s.hJ,{user:r}=await (0,s.rh)(c,e);await f(r),t.push("/dashboard")}catch(e){throw g(p(e)),e}finally{v(!1)}},j=async(e,r,n)=>{try{g(null),v(!0);let{user:a}=await (0,s.Xb)(c,e,r);await f(a,{name:n}),t.push("/dashboard")}catch(e){throw console.error("Signup error:",e),g(p(e)),e}finally{v(!1)}},k=async()=>{try{v(!0),await (0,s.w7)(c),t.push("/login")}catch(e){throw g(p(e)),e}finally{v(!1)}};return(0,n.jsx)(h.Provider,{value:{currentUser:o,loading:w||b,error:y,signIn:x,signInWithGoogle:E,signUp:j,signOut:k,clearError:()=>g(null)},children:r})}function m(){let e=(0,a.useContext)(h);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[853,139,546,971,117,744],function(){return e(e.s=6988)}),_N_E=e.O()}]);